---
title: SAP BTP - Node.js Apllication를 Kyma에 배포하기
published: true
---

SAP BTP Cockpit에 접속하여 하위 계정으로 들어간다.
하위 계정의 하위 도메인을 복사한다.
![image](https://github.com/BJSNuruhee/levelup/assets/88364980/7b6bcf41-8c31-43d8-a948-9a9c9769acd9)

Kyma Cluster domain을 확인해야 한다.
이전에 받았던 kubeconfig.yml에서 확인한다.

![image](https://github.com/BJSNuruhee/levelup/assets/88364980/bdf3b793-7e2b-4e7e-bb22-e6bc5976410f)

//https://api.ccc3b58.kyma.ondemand.com

전 단계에서 어플리케이션을 Kyma 환경에 배포하기 위해선 OCI image를 만들어서 배포해야 한다.
해당 이미지는 pack tool을 이용하여 만든다.

Chocolatey 를 사용하여 설치할건데 설치가 안된 사람들은 구글링하여 찾아보세요..

```
choco install pack --version=0.33.2
```

![image](https://github.com/BJSNuruhee/levelup/assets/88364980/c5a6fe7c-d507-4ef0-9358-b7c1ee7768f6)


packtool을 사용하여 OCI image를 빌드해 봅시다
```
pack build <dockerhub 계정>/multitenant-kyma-backend:v1 --builder paketobuildpacks/builder-jammy-base
```

빌드가 성공하면 이미지를 확인한다. (물론 도커가 설치가 되어있어야 합니다.)
```
docker images
```

![image](https://github.com/BJSNuruhee/levelup/assets/88364980/684a51a2-45f8-424e-9ccb-1a2bcadf0e2e)

docker에 로그인 하고 hub에 push해보자

이 때 로그인 할 때 계정은 이메일 이지만 @ 앞에만 써도 로그인이 되더랍..

```
docker login -u nuruhee -p 패스워드
```

이후 docker hub에 push 해보자
```
docker push nuruhee/multitenant-kyma-backend:v1
```

![image](https://github.com/BJSNuruhee/levelup/assets/88364980/2771de8b-972f-453a-ace0-11c79eb5be66)

![image](https://github.com/BJSNuruhee/levelup/assets/88364980/bd79d1b0-f41a-4a46-b1b2-71fcb276a9b9)

Docker hub에 배포된 이미지를 Kyma 환경에서 가져와보자

하위계정에서 대시보드에 링크 클릭
![image](https://github.com/BJSNuruhee/levelup/assets/88364980/3360e378-ae8a-46d9-aae4-e5e3321b5059)

NameSpace를 만들어주고
![image](https://github.com/BJSNuruhee/levelup/assets/88364980/abc57004-2291-4376-bdbc-258ddc7dddb7)

Kyma가 Docker Hub에서 가져올 수 있도록 액세스 정보 설정
```
kubectl -n nuruhee create secret docker-registry registry-secret --docker-server=https://index.docker.io/v1/  --docker-username=nuruhee --docker-password=패스워드 --docker-email=nuruhee@gmail.com
```

명령어를 통해 액세스 정보를 설정하려고 하니 실패하였다.
```
error: failed to create secret Post "http://localhost:8080/api/v1/namespaces/nuruhee/secrets?fieldManager=kubectl-create&fieldValidation=Strict": dial tcp [::1]:8080: connectex: No connection could be made because the target machine actively refused it.
```

